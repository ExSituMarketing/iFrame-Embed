/*!
 * iFrame-Embed multi-function iframe embed script v2.0.0
 * https://github.com/ExSituMarketing/iFrame-Embed
 *
 * Copyright 2015 Ex Situ Marketing
 * Released under the MIT license 
 */
var J50Npi={currentScript:null,getJSON:function(b,d,h){var g=b+(b.indexOf("?")+1?"&":"?");var c=document.getElementsByTagName("head")[0];var a=document.createElement("script");var f=[];var e="";this.success=h;d.callback="J50Npi.success";for(e in d){f.push(e+"="+encodeURIComponent(d[e]))}g+=f.join("&");a.type="text/javascript";a.src=g;if(this.currentScript){c.removeChild(currentScript)}c.appendChild(a)},success:null};window.document.getElementsByClassName=function(cl){var retnode=[];var elem=this.getElementsByTagName("*");for(var i=0;i<elem.length;i++){if((" "+elem[i].className+" ").indexOf(" "+cl+" ")>-1)retnode.push(elem[i])}return retnode};(function(window,ao){ao.init=function(window,ao){ao.document=window.document;ao.params={hasResponsive:false,hasRefresh:false,asyncImpressionLog:true,mobileWidth:600,isActiveWindow:true,protocol:"https"};ao.elements=[];ao.fwidth=[];ao.fheight=[];ao.responsiveSteps={300:"250",728:"90",962:"102",1144:"250",600:"250"};ao.messageID=[];ao.timerID=[];ao.refreshTimer={mobile:6e3,desktop:12e3};ao.totalViewportTimer=[];ao.inViewportTimer=[];ao.autoRefreshTime=[]},ao.setDocument=function(doc){ao.document=doc},ao.getClient=function(){if(Math.max(ao.document.documentElement.clientWidth,window.innerWidth||0)<=ao.params.mobileWidth){return"mobile"}return"desktop"},ao.defaultTimerID=function(e){if(e&&e.id&&!ao.timerID[e.id]){ao.timerID[e.id]=0}else{return false}return ao.timerID[e.id]},ao.handleRefresh=function(e){if(e===null){return false}ao.defaultTimerID(e);if(ao.isAutoRefresh(e)===true&&ao.inViewport(e.id)!==false&&ao.params.isActiveWindow===true){var refreshTime=ao.getCampaignRefreshTime(e.id);ao.startTimer(e,refreshTime)}return true},ao.inTimer=function(e){if(ao.isAutoRefresh(e)===true&&ao.inViewport(e.id)!==false&&ao.params.isActiveWindow===true){ao.loadFrame(e);ao.resetInTimer(e);return true}else{ao.stopTimer(e);return false}},ao.resetInTimer=function(e){var clientMethod=ao.getClient();var refreshTime=ao.getCampaignRefreshTime(e.id);if(ao.refreshTimer[clientMethod]!=refreshTime){ao.stopTimer(e);ao.startTimer(e,refreshTime)}},ao.startTimer=function(e,refreshTime){try{if(typeof ao.timerID[e.id]==="undefined"||ao.timerID[e.id]===0){ao.timerID[e.id]=setInterval(function(){ao.inTimer(e)},refreshTime)}return true}catch(ex){return false}},ao.getCampaignRefreshTime=function(id){var clientMethod=ao.getClient();if(typeof ao.autoRefreshTime[id]=="object"&&ao.autoRefreshTime[id][clientMethod]>0){return ao.autoRefreshTime[id][clientMethod]}return ao.refreshTimer[clientMethod]};ao.stopTimer=function(e){try{clearInterval(ao.timerID[e.id]);ao.timerID[e.id]=0}catch(ex){return false}return true},ao.inViewport=function(id){try{var windowSize=ao.getWindowSize();var viewport=ao.getViewportSize(windowSize);var bounds=ao.getBoundPos(id,windowSize);return!(viewport.right<bounds.left||viewport.left>bounds.right||viewport.bottom<Number(bounds.top)+Number(windowSize.scrollTop)||bounds.bottom<0)}catch(ex){return true}},ao.getBoundPos=function(id,windowSize){var AoFrame=document.getElementById(id);var bounds=document.getElementById(id).getBoundingClientRect();bounds.right=Number(bounds.left)+Number(windowSize.scrollLeft)+Number(AoFrame.width);bounds.bottom=Number(bounds.top)+Number(windowSize.scrollTop)+Number(AoFrame.height);return bounds},ao.getViewportSize=function(windowSize){return{top:windowSize.scrollTop,left:windowSize.scrollLeft,right:windowSize.scrollLeft+windowSize.width,bottom:windowSize.scrollTop+windowSize.height}},ao.getWindowSize=function(){return{scrollLeft:ao.getScrollLeft(),scrollTop:ao.getScrollTop(),width:ao.getParentWidthPos(),height:ao.getParentHeightPos()}},ao.getScrollLeft=function(){return window.pageXOffset!==undefined?window.pageXOffset:(document.body||document.body.parentNode||document.documentElement).scrollLeft},ao.getScrollTop=function(){return window.pageYOffset!==undefined?window.pageYOffset:(document.body||document.body.parentNode||document.documentElement).scrollTop},ao.getParentWidthPos=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},ao.getParentHeightPos=function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},ao.appendFramewidth=function(a,e){if(ao.isResponsive(e)===true){a.push("frameWidth="+ao.fwidth[e.id])}return a},ao.appendAsyncImpressionLogging=function(a){if(ao.params.asyncImpressionLog===true){a.push("ail=1")}return a},ao.getCurrentUrl=function(a){var currentUrl=window.location.href;if(currentUrl){a.push("ref="+currentUrl)}return a},ao.getUrlAppend=function(e){var append=[];ao.appendFramewidth(append,e);ao.appendAsyncImpressionLogging(append);ao.getCurrentUrl(append);return ao.niceQueryString(append)},ao.niceQueryString=function(args){if(args.length>0){return"?"+args.join("&")}return""},ao.getParentWidth=function(e){try{return e.parentNode.offsetWidth}catch(ex){return e.width}},ao.getReponsiveFrameWidth=function(w){var fWidth=w;if(w<600){fWidth="300"}else if(w<728&&w>=600){fWidth="600"}else if(w<962&&w>=728){fWidth="728"}else if(w<1144&&w>=962){fWidth="962"}else{fWidth="1144"}return fWidth},ao.setIframeParams=function(e){ao.isAutoRefresh(e);if(ao.isResponsive(e)===true){ao.fwidth[e.id]=ao.getReponsiveFrameWidth(ao.getParentWidth(e));ao.fheight[e.id]=ao.responsiveSteps[ao.fwidth[e.id]]}else{ao.fwidth[e.id]=ao.getFrameWidth(e);ao.fheight[e.id]=ao.getFrameHeight(e)}},ao.getFrameWidth=function(e){try{return e.width}catch(ex){return 0}},ao.getFrameHeight=function(e){try{return e.height}catch(ex){return 0}},ao.getDatasetDomainFromLocation=function(e){try{var arr=ao.getDataset(e,"data-loc").split("/");return arr[0]}catch(ex){return false}},ao.getDatasetLocation=function(e){try{return ao.getDataset(e,"data-loc")}catch(ex){return""}},ao.isAutoRefresh=function(e){var refresh=ao.getDatasetBoolean(e,"data-ref");if(refresh==="true"){ao.params.hasRefresh=true;return true}return false},ao.isResponsive=function(e){var responsive=ao.getDatasetBoolean(e,"data-res");if(responsive==="true"){ao.params.hasResponsive=true;return true}return false},ao.getLocation=function(r){var loc=ao.params.protocol+"://"+ao.getDatasetLocation(r)+ao.getUrlAppend(r);return loc},ao.loadFrame=function(e){try{ao.inViewportTimer[e.id]=0;ao.setIframeParams(e);e.src=ao.getLocation(e);e.width=ao.fwidth[e.id];e.height=ao.fheight[e.id];e.style.display="block";e.onload=function(){ao.postMessageSender(e)}}catch(ex){return false}},ao.getDatasetBoolean=function(e,a){try{return ao.getDataset(e,a)}catch(ex){return false}},ao.getDataset=function(e,a){var dset=e.getAttribute(a);return dset},ao.loadResponsiveFrames=function(e){if(ao.isResponsive(e)===true&&ao.getReponsiveFrameWidth(ao.getParentWidth(e))!==ao.getFrameWidth(e)){ao.loadFrame(e)}},ao.setIsActiveWindow=function(){ao.params.isActiveWindow=true;ao.executeRefresh()},ao.setIsInActiveWindow=function(){ao.params.isActiveWindow=false},ao.MoveAway=function(){for(var i=0;i<ao.elements.length;i++){if(typeof ao.elements[i]!=="undefined"){ao.MoveAwayLogging(ao.elements[i])}}},ao.MoveAwayLogging=function(e){if(typeof ao.totalViewportTimer[e.id]!=="undefined"&&ao.totalViewportTimer[e.id]<900){var target=ao.getDatasetDomainFromLocation(e);e.contentWindow.postMessage("total|"+ao.totalViewportTimer[e.id],ao.params.protocol+"://"+target)}},ao.executeResponsive=function(){if(ao.params.hasResponsive===true){ao.each("loadResponsiveFrames")}},ao.executeRefresh=function(){if(ao.params.hasRefresh===true){ao.each("handleRefresh")}},ao.execute=function(){ao.each("loadFrame")},ao.each=function(m){for(var i=0;i<ao.elements.length;i++){if(typeof ao.elements[i]!=="undefined"){ao[m](ao.elements[i])}}},ao.setTotalInViewportTimer=function(){for(var i=0;i<ao.elements.length;i++){if(typeof ao.elements[i]!=="undefined"){ao.totalViewportTimer[ao.elements[i].id]=0;ao.inViewportTimer[ao.elements[i].id]=0}}},ao.attachListeners=function(){ao.attacheRefreshListeners();ao.attacheResponsiveListeners();ao.attachActiveWindowListeners();ao.attachMoveAwayListeners()},ao.attacheRefreshListeners=function(){if(window.addEventListener){window.addEventListener("scroll",ao.setIsActiveWindow,false)}else{window.attachEvent("onscroll",ao.setIsActiveWindow)}},ao.attachActiveWindowListeners=function(){window.onfocus=ao.setIsActiveWindow;window.onblur=ao.setIsInActiveWindow},ao.attachMoveAwayListeners=function(){window.onbeforeunload=ao.MoveAway},ao.attacheResponsiveListeners=function(){window.onresize=ao.executeResponsive},ao.asyncImpressionLogger=function(e){try{ao.sendLog(e)}catch(ex){return false}},ao.sendLog=function(e){var target=ao.getDatasetDomainFromLocation(e);if(ao.inViewport(e.id)!==false&&target!==false&&ao.params.isActiveWindow===true){ao.totalViewportTimer[e.id]++;ao.inViewportTimer[e.id]++;e.contentWindow.postMessage("in|"+ao.inViewportTimer[e.id]+"|"+ao.totalViewportTimer[e.id],ao.params.protocol+"://"+target)}else{ao.inViewportTimer[e.id]=0}},ao.postMessageSender=function(e){if(ao.params.asyncImpressionLog===true){ao.stopMessage(e);ao.startMessage(e)}},ao.stopMessage=function(e){if(ao.messageID[e.id]){clearInterval(ao.messageID[e.id]);ao.messageID[e.id]=0}},ao.startMessage=function(e){if(typeof ao.messageID[e.id]==="undefined"||ao.messageID[e.id]===0){ao.messageID[e.id]=setInterval(function(){ao.asyncImpressionLogger(e)},1e3)}},ao.callback=function(response){for(var key in response){var id="async"+key;ao.autoRefreshTime[id]=response[key]}},ao.getAoCampaignParameters=function(){var data={};var url="";for(var i=0;i<ao.elements.length;i++){url="//"+ao.getDatasetDomainFromLocation(ao.elements[i])+"/json/"+ao.elements[i].id.replace("async","");J50Npi.getJSON(url,data,ao.callback)}},ao.run=function(){ao.document=window.document;ao.elements=ao.document.getElementsByClassName("aoembed");ao.getAoCampaignParameters();ao.setTotalInViewportTimer();ao.attachListeners();ao.execute();ao.executeRefresh()},function(){ao.init(window,ao);ao.run()}()})(window,AOembed=window.AOembed||{});(function(exports,d){function domReady(fn,context){function onReady(event){d.removeEventListener("DOMContentLoaded",onReady);fn.call(context||exports,event)}function onReadyIe(event){if(d.readyState==="complete"){d.detachEvent("onreadystatechange",onReadyIe);fn.call(context||exports,event)}}d.addEventListener&&d.addEventListener("DOMContentLoaded",onReady)||d.attachEvent&&d.attachEvent("onreadystatechange",onReadyIe)}exports.domReady=domReady})(window,document);domReady(function(){AOembed.run()});